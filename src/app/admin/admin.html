<div class="admin-container">
  <div class="admin-header">
    <h1>Admin Portal</h1>
    <p class="subtitle">Manage products and view system statistics</p>
  </div>

  <!-- Tab Navigation -->
  <div class="tab-navigation">
    <button 
      class="tab-button" 
      [class.active]="activeTab === 'dashboard'"
      (click)="switchTab('dashboard')">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
        <line x1="9" y1="9" x2="15" y2="9"></line>
        <line x1="9" y1="15" x2="15" y2="15"></line>
        <line x1="9" y1="12" x2="12" y2="12"></line>
      </svg>
      Dashboard
    </button>
    <button 
      class="tab-button" 
      [class.active]="activeTab === 'view-products'"
      (click)="switchTab('view-products')">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
        <polyline points="14,2 14,8 20,8"></polyline>
        <line x1="16" y1="13" x2="8" y2="13"></line>
        <line x1="16" y1="17" x2="8" y2="17"></line>
        <polyline points="10,9 9,9 8,9"></polyline>
      </svg>
      View Products
    </button>
    <button 
      class="tab-button" 
      [class.active]="activeTab === 'add-product'"
      (click)="switchTab('add-product')">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
      </svg>
      Add Product
    </button>
  </div>

  <!-- Dashboard Tab -->
  <div class="tab-content" *ngIf="activeTab === 'dashboard'">
    <!-- Real-time Traffic Section -->
    <div class="stats-section">
      <h2>Real-time Traffic</h2>
      <div class="traffic-grid">
        <div class="traffic-card">
          <div class="traffic-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
          </div>
          <div class="traffic-info">
            <div class="traffic-number">{{ currentVisitors }}</div>
            <div class="traffic-label">Current Visitors</div>
          </div>
        </div>
        
        <div class="traffic-card">
          <div class="traffic-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="16" y1="2" x2="16" y2="6"></line>
              <line x1="8" y1="2" x2="8" y2="6"></line>
              <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
          </div>
          <div class="traffic-info">
            <div class="traffic-number">{{ todayVisitors }}</div>
            <div class="traffic-label">Today</div>
          </div>
        </div>
        
        <div class="traffic-card">
          <div class="traffic-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14,2 14,8 20,8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
              <polyline points="10,9 9,9 8,9"></polyline>
            </svg>
          </div>
          <div class="traffic-info">
            <div class="traffic-number">{{ weeklyVisitors }}</div>
            <div class="traffic-label">This Week</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Overview Statistics -->
    <div class="stats-section">
      <h2>System Overview</h2>
      <div class="overview-grid">
        <div class="overview-card">
          <div class="overview-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 7h-3V6a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v1H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"></path>
              <path d="M9 12l2 2 4-4"></path>
            </svg>
          </div>
          <div class="overview-info">
            <div class="overview-number">{{ totalProducts }}</div>
            <div class="overview-label">Total Products</div>
          </div>
        </div>
        
        <div class="overview-card">
          <div class="overview-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14,2 14,8 20,8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
              <polyline points="10,9 9,9 8,9"></polyline>
            </svg>
          </div>
          <div class="overview-info">
            <div class="overview-number">{{ totalReviews }}</div>
            <div class="overview-label">Total Reviews</div>
          </div>
        </div>
        
        <div class="overview-card">
          <div class="overview-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polygon points="23 7 16 12 23 17 23 7"></polygon>
              <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
            </svg>
          </div>
          <div class="overview-info">
            <div class="overview-number">{{ ((averageRatings.transportability + averageRatings.easeOfUse + averageRatings.interoperability + averageRatings.detection + averageRatings.reliability) / 5).toFixed(1) }}</div>
            <div class="overview-label">Average Rating</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Charts and Analytics -->
    <div class="charts-grid">
      <!-- Reviews by Service Branch -->
      <div class="chart-card">
        <h3>Reviews by Service Branch</h3>
        <div class="chart-content">
          <div class="branch-item" *ngFor="let branch of reviewsByBranch | keyvalue">
            <div class="branch-name">{{ branch.key }}</div>
            <div class="branch-bar">
              <div class="branch-fill" [style.width.%]="(branch.value / totalReviews) * 100"></div>
            </div>
            <div class="branch-count">{{ branch.value }}</div>
          </div>
        </div>
      </div>

      <!-- Reviews by Role -->
      <div class="chart-card">
        <h3>Reviews by Role</h3>
        <div class="chart-content">
          <div class="role-item" *ngFor="let role of reviewsByRole | keyvalue">
            <div class="role-name">{{ role.key }}</div>
            <div class="role-bar">
              <div class="role-fill" [style.width.%]="(role.value / totalReviews) * 100"></div>
            </div>
            <div class="role-count">{{ role.value }}</div>
          </div>
        </div>
      </div>

      <!-- Average Ratings by Category -->
      <div class="chart-card">
        <h3>Average Ratings by Category</h3>
        <div class="ratings-chart">
          <div class="rating-item">
            <span class="rating-label">Transportability</span>
            <div class="rating-bar">
              <div class="rating-fill" [style.width.%]="(averageRatings.transportability / 5) * 100"></div>
            </div>
            <span class="rating-value">{{ averageRatings.transportability }}/5</span>
          </div>
          <div class="rating-item">
            <span class="rating-label">Ease of Use</span>
            <div class="rating-bar">
              <div class="rating-fill" [style.width.%]="(averageRatings.easeOfUse / 5) * 100"></div>
            </div>
            <span class="rating-value">{{ averageRatings.easeOfUse }}/5</span>
          </div>
          <div class="rating-item">
            <span class="rating-label">Interoperability</span>
            <div class="rating-bar">
              <div class="rating-fill" [style.width.%]="(averageRatings.interoperability / 5) * 100"></div>
            </div>
            <span class="rating-value">{{ averageRatings.interoperability }}/5</span>
          </div>
          <div class="rating-item">
            <span class="rating-label">Detection</span>
            <div class="rating-bar">
              <div class="rating-fill" [style.width.%]="(averageRatings.detection / 5) * 100"></div>
            </div>
            <span class="rating-value">{{ averageRatings.detection }}/5</span>
          </div>
          <div class="rating-item">
            <span class="rating-label">Reliability</span>
            <div class="rating-bar">
              <div class="rating-fill" [style.width.%]="(averageRatings.reliability / 5) * 100"></div>
            </div>
            <span class="rating-value">{{ averageRatings.reliability }}/5</span>
          </div>
        </div>
      </div>

      <!-- Word Frequency Analysis -->
      <div class="chart-card">
        <h3>Most Used Words in Reviews</h3>
        <div class="word-cloud">
          <div class="word-item" *ngFor="let word of filteredWords" [style.font-size.px]="12 + (word.count * 2)">
            {{ word.word }} <span class="word-count">({{ word.count }})</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Recent Reviews -->
    <div class="recent-reviews-section">
      <h2>Recent Reviews</h2>
      <div class="recent-reviews-list">
        <div class="recent-review-item" *ngFor="let review of recentReviews">
          <div class="review-header">
            <div class="reviewer-info">
              <strong>{{ review.author }}</strong> - {{ review.milService }} ({{ review.role }})
            </div>
            <div class="review-date">{{ review.date }}</div>
          </div>
          <div class="review-product">{{ review.productName }}</div>
          <div class="review-rating">
            Overall: {{ ((review.categoryRatings.transportability + review.categoryRatings.easeOfUse + review.categoryRatings.interoperability + review.categoryRatings.detection + review.categoryRatings.reliability) / 5).toFixed(1) }}/5
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- View Products Tab -->
  <div class="tab-content" *ngIf="activeTab === 'view-products'">
    <div class="stats-section">
      <h2>Current Products</h2>
      <p class="subtitle">Overview of all products in the system</p>
      
      <div class="products-grid">
        <div class="product-card" *ngFor="let product of products">
          <div class="product-image">
            <img [src]="product.image" [alt]="product.name" />
          </div>
          <div class="product-info">
            <h3 class="product-name">{{ product.name }}</h3>
            <p class="product-manufacturer">{{ product.manufacturer }}</p>
            <p class="product-category">{{ product.category }}</p>
            <p class="product-price">{{ product.price }}</p>
            <p class="product-description">{{ product.description | slice:0:100 }}...</p>
            <div class="product-specs" *ngIf="product.specifications && product.specifications.length > 0">
              <strong>Specifications:</strong>
              <ul>
                <li *ngFor="let spec of product.specifications | slice:0:3">{{ spec }}</li>
                <li *ngIf="product.specifications.length > 3">...and {{ product.specifications.length - 3 }} more</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <form (ngSubmit)="onSubmit()" class="admin-form">
    <div class="form-section">
      <h2>Basic Information</h2>
      
      <div class="form-group">
        <label for="name">Product Name <span class="required">*</span></label>
        <input 
          type="text" 
          id="name" 
          name="name" 
          [(ngModel)]="product.name" 
          required
          placeholder="e.g., Roadrunner-M"
        />
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="manufacturer">Manufacturer <span class="required">*</span></label>
          <input 
            type="text" 
            id="manufacturer" 
            name="manufacturer" 
            [(ngModel)]="product.manufacturer" 
            required
            placeholder="e.g., Anduril Industries"
          />
        </div>

        <div class="form-group">
          <label for="category">Category <span class="required">*</span></label>
          <input 
            type="text" 
            id="category" 
            name="category" 
            [(ngModel)]="product.category" 
            required
            placeholder="e.g., Air Defense Interceptor"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="price">Price <span class="required">*</span></label>
          <input 
            type="text" 
            id="price" 
            name="price" 
            [(ngModel)]="product.price" 
            required
            placeholder="e.g., Contact for Pricing"
          />
        </div>

        <div class="form-group">
          <label for="image">Image URL</label>
          <input 
            type="url" 
            id="image" 
            name="image" 
            [(ngModel)]="product.image"
            placeholder="https://example.com/image.jpg"
          />
        </div>
      </div>
    </div>

    <div class="form-section">
      <h2>Description</h2>
      
      <div class="form-group">
        <label for="description">Product Description <span class="required">*</span></label>
        <textarea 
          id="description" 
          name="description" 
          [(ngModel)]="product.description" 
          required
          rows="5"
          placeholder="Enter a detailed description of the product..."
        ></textarea>
      </div>
    </div>

    <div class="form-section">
      <h2>Specifications</h2>
      
      <div class="specifications-input">
        <input 
          type="text" 
          [(ngModel)]="newSpecification" 
          name="newSpecification"
          placeholder="Enter a specification and click Add"
          (keypress.enter)="$event.preventDefault(); addSpecification()"
        />
        <button type="button" class="btn-add-spec" (click)="addSpecification()">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          Add Specification
        </button>
      </div>

      <div class="specifications-list" *ngIf="product.specifications && product.specifications.length > 0">
        <div class="spec-item" *ngFor="let spec of product.specifications; let i = index">
          <span>{{ spec }}</span>
          <button type="button" class="btn-remove" (click)="removeSpecification(i)">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <div class="form-actions">
      <button type="button" class="btn-cancel" (click)="cancel()">Cancel</button>
      <button type="submit" class="btn-submit">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="20,6 9,17 4,12"></polyline>
        </svg>
        Add Product
      </button>
    </div>
  </form>
</div>
